<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caro Battle - Trận Đấu</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>

    <div id="game-ui" class="game-container">
        
        <div class="board-wrapper">
            <div style="margin-bottom:15px; font-weight:700; display:flex; justify-content:space-between; align-items: center;">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <i class="fas fa-hashtag text-gray-400"></i>
                    <span>Mã Phòng: <span style="color:var(--primary); font-weight: 900;" id="room-display">Đang tải...</span></span>
                </div>
            </div>
            
            <div class="caro-grid" id="grid"></div>
        </div>

        <div class="game-sidebar">
            
            <div class="turn-card" id="status-box">
                <div class="turn-label">LƯỢT ĐI HIỆN TẠI</div>
                <div class="current-turn" id="turn" style="color: #e74c3c;">X</div>
            </div>

            <div class="turn-card" style="display:flex; justify-content:space-around; align-items:center; padding: 15px;">
                <div style="text-align:center;">
                    <div style="width:45px; height:45px; background:#f1f5f9; border-radius:50%; display:flex; align-items:center; justify-content:center; color:#64748b; margin:0 auto 5px;">
                        <i class="fas fa-user"></i>
                    </div>
                    <small style="font-weight: 700; display: block;" id="my-info">Bạn</small>
                </div>
                
                <b style="font-size: 20px; color: #cbd5e1;">VS</b>
                
                <div style="text-align:center;">
                    <div style="width:45px; height:45px; background:#fee2e2; border-radius:50%; display:flex; align-items:center; justify-content:center; color:#ef4444; margin:0 auto 5px;">
                        <i class="fas fa-user-secret"></i>
                    </div>
                    <small style="font-weight: 700; display: block;" id="opp-name">Đối thủ</small>
                </div>
            </div>

            <div class="chat-container">
                <div class="chat-header">
                    <i class="fas fa-comments mr-2"></i> Trò chuyện
                </div>
                <div id="chat-box" class="chat-box">
                    <div style="text-align: center; color: #94a3b8; font-size: 13px; margin-top: 10px;">
                        <i class="fas fa-circle-notch fa-spin"></i> Đang kết nối server...
                    </div>
                </div>
                <div class="chat-input-area">
                    <input type="text" id="chat-input" class="chat-input" placeholder="Nhập tin nhắn...">
                    <button class="btn-send" onclick="window.sendMessage()">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>

            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                <button class="btn btn-red-solid" style="width:100%" onclick="window.confirmAction('surrender')">
                    <i class="fas fa-flag"></i> Đầu hàng
                </button>
                <button class="btn btn-outline" style="width:100%" onclick="window.handleReplay()">
                    <i class="fas fa-redo"></i> F5
                </button>
                <button class="btn btn-outline" style="grid-column: span 2; color: #64748b;" onclick="window.confirmAction('exit')">
                    <i class="fas fa-sign-out-alt"></i> Rời phòng
                </button>
            </div>
        </div>
    </div>

    <div id="modal-result" class="modal-overlay hidden">
        <div class="result-card">
            <h1 class="res-title">KẾT QUẢ TRẬN ĐẤU</h1>
            
            <p style="color:#64748b; font-size: 14px; font-weight: 600;">NGƯỜI CHIẾN THẮNG</p>
            <div id="winner-name">...</div>

            <div class="res-flex">
                <div class="res-box">
                    <div class="res-avatar"><i class="fas fa-user"></i></div>
                    <span class="res-name">BẠN</span>
                    <span class="res-status">...</span> </div>

                <div class="res-box">
                    <div class="res-avatar"><i class="fas fa-user-secret"></i></div>
                    <span class="res-name">ĐỐI THỦ</span>
                    <span class="res-status">...</span> </div>
            </div>

            <div class="modal-actions">
                <button class="btn btn-confirm" onclick="window.handleReplay()">
                    <i class="fas fa-redo mr-1"></i> CHƠI VÁN MỚI
                </button>
                <button class="btn btn-cancel" onclick="window.location.href='index.html'">
                    <i class="fas fa-home mr-1"></i> VỀ SẢNH
                </button>
            </div>
        </div>
    </div>

    <div id="modal-confirm" class="modal-overlay hidden">
        <div class="confirm-modal">
            <i id="confirm-icon" class="confirm-icon"></i>
            <h3 id="confirm-title" class="confirm-title"></h3>
            <p id="confirm-desc" class="confirm-desc"></p>
            
            <div class="modal-actions">
                <button class="btn btn-danger" onclick="window.executeConfirm()">ĐỒNG Ý</button>
                <button class="btn btn-cancel" onclick="window.closeConfirm()">HỦY BỎ</button>
            </div>
        </div>
    </div>

    <script type="module" src="main.js"></script>
</body>
</html>