<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caro Battle - Trận Đấu</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>

    <div id="game-ui" class="game-container">
        
        <div class="board-wrapper">
            <div style="margin-bottom:15px; font-weight:700; display:flex; justify-content:space-between; align-items: center;">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <i class="fas fa-hashtag text-gray-400"></i>
                    <span>Mã Phòng: <span style="color:var(--primary); font-weight: 900;" id="room-display">Đang tải...</span></span>
                </div>
            </div>
            
            <div class="caro-grid" id="grid"></div>
        </div>

        <div class="game-sidebar">
            
            <div class="turn-card" id="status-box">
                <div class="turn-label">THỜI GIAN SUY NGHĨ</div>
                <div class="timer-display" id="timer-display">30s</div>
                <div style="margin-top:5px; font-size:13px; color:#64748b;">
                    Lượt của: <span id="turn" style="font-weight:800;">X</span>
                </div>
            </div>

            <div class="turn-card" style="display:flex; justify-content:space-around; align-items:center; padding: 15px;">
                <div style="text-align:center;">
                    <div style="width:45px; height:45px; background:#f1f5f9; border-radius:50%; display:flex; align-items:center; justify-content:center; color:#64748b; margin:0 auto 5px;">
                        <i class="fas fa-user"></i>
                    </div>
                    <small style="font-weight: 700; display: block;" id="my-info">Bạn</small>
                </div>
                
                <b style="font-size: 20px; color: #cbd5e1;">VS</b>
                
                <div style="text-align:center;">
                    <div style="width:45px; height:45px; background:#fee2e2; border-radius:50%; display:flex; align-items:center; justify-content:center; color:#ef4444; margin:0 auto 5px;">
                        <i class="fas fa-user-secret"></i>
                    </div>
                    <small style="font-weight: 700; display: block;" id="opp-name">Đối thủ</small>
                </div>
            </div>

            <div class="chat-container">
                <div class="chat-header">
                    <i class="fas fa-comments mr-2"></i> Trò chuyện
                </div>
                <div id="chat-box" class="chat-box"></div>
                <div class="chat-input-area">
                    <input type="text" id="chat-input" class="chat-input" placeholder="Nhập tin nhắn...">
                    <button class="btn-send" onclick="window.sendMessage()">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>

            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                <button class="btn btn-outline" style="border-color:#f59e0b; color:#d97706;" onclick="window.confirmAction('draw')">
                    <i class="fas fa-handshake"></i> Xin Hòa
                </button>
                <button class="btn btn-outline" style="border-color:#3b82f6; color:#2563eb;" onclick="window.confirmAction('undo')">
                    <i class="fas fa-undo"></i> Đi Lại
                </button>
                
                <button class="btn btn-red-solid" style="grid-column: span 2;" onclick="window.confirmAction('surrender')">
                    <i class="fas fa-flag"></i> ĐẦU HÀNG
                </button>

                <button class="btn btn-outline" style="width:100%" onclick="window.handleReplay()">
                    <i class="fas fa-redo"></i> Chơi Lại
                </button>
                <button class="btn btn-outline" style="width:100%; color: #64748b;" onclick="window.confirmAction('exit')">
                    <i class="fas fa-sign-out-alt"></i> Thoát
                </button>
            </div>
        </div>
    </div>

    <div id="modal-result" class="modal-overlay hidden">
        <div class="result-card">
            <h1 class="res-title">KẾT QUẢ TRẬN ĐẤU</h1>
            <div id="winner-name" style="font-size:20px; font-weight:800; margin:20px 0;">...</div>
            
            <div class="res-flex">
                <div class="res-box">
                    <div class="res-avatar"><i class="fas fa-user"></i></div>
                    <span class="res-name">BẠN</span>
                    <span class="res-status">...</span> 
                </div>
                <div class="res-box">
                    <div class="res-avatar"><i class="fas fa-user-secret"></i></div>
                    <span class="res-name">ĐỐI THỦ</span>
                    <span class="res-status">...</span> 
                </div>
            </div>

            <div class="modal-actions">
                <button class="btn btn-confirm" onclick="window.handleReplay()">
                    <i class="fas fa-redo mr-1"></i> CHƠI VÁN MỚI
                </button>
                <button class="btn btn-cancel" onclick="window.location.href='index.html'">
                    <i class="fas fa-home mr-1"></i> VỀ SẢNH
                </button>
            </div>
        </div>
    </div>

    <div id="modal-confirm" class="modal-overlay hidden">
        <div class="confirm-modal">
            <i id="confirm-icon" class="confirm-icon" style="font-size:40px; margin-bottom:15px; display:block;"></i>
            <h3 id="confirm-title" class="confirm-title" style="margin-bottom:10px; font-size:20px;"></h3>
            <p id="confirm-desc" class="confirm-desc" style="color:#64748b; margin-bottom:25px;"></p>
            
            <div class="modal-actions" style="display:flex; justify-content:center; gap:10px;">
                <button class="btn btn-primary" style="width:auto;" onclick="window.executeConfirm()">ĐỒNG Ý</button>
                <button class="btn btn-outline" style="width:auto;" onclick="window.closeConfirm()">HỦY BỎ</button>
            </div>
        </div>
    </div>

    <script type="module" src="main.js"></script>
</body>
</html>